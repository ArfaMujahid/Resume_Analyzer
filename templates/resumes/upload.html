{% extends 'base.html' %}
{% load static %}

{% block title %}Upload Resume - {{ site_name }}{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg">
                <div class="card-body p-5">
                    <h2 class="card-title text-center mb-4">Upload Resume</h2>
                    <p class="text-center text-muted mb-5">
                        Upload your resume in PDF, DOC, DOCX, or TXT format
                    </p>

                    <form method="post" enctype="multipart/form-data" novalidate>
                        {% csrf_token %}

                        <div class="mb-4">
                            <label for="{{ form.file.id_for_label }}" class="form-label">
                                Select Resume File
                            </label>
                            <div class="upload-area" id="uploadArea">
                                <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                <p class="mb-2">Drag and drop your resume here or</p>
                                <input type="file" name="{{ form.file.name }}" id="{{ form.file.id_for_label }}"
                                       class="form-control" accept=".pdf,.doc,.docx,.txt" required>
                                <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('{{ form.file.id_for_label }}').click()">
                                    Browse Files
                                </button>
                            </div>
                            {% if form.file.errors %}
                                <div class="text-danger small mt-2">
                                    {{ form.file.errors.0 }}
                                </div>
                            {% endif %}
                            <div class="form-text">
                                {{ form.file.help_text }}
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <h6><i class="fas fa-info-circle me-2"></i>File Requirements</h6>
                            <ul class="mb-0 small">
                                <li>Maximum file size: 20MB</li>
                                <li>Supported formats: PDF, DOC, DOCX, TXT</li>
                                <li>Files are processed automatically after upload</li>
                                <li>Your data is kept private and secure</li>
                            </ul>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg" id="uploadBtn">
                                <i class="fas fa-upload me-2"></i>Upload Resume
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="text-center mt-4">
                <a href="{% url 'resumes:list' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to My Resumes
                </a>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('uploadArea').addEventListener('dragover', (e) => {
    e.preventDefault();
    e.stopPropagation();
    document.getElementById('uploadArea').classList.add('dragover');
});

document.getElementById('uploadArea').addEventListener('dragleave', (e) => {
    e.preventDefault();
    e.stopPropagation();
    document.getElementById('uploadArea').classList.remove('dragover');
});

document.getElementById('uploadArea').addEventListener('drop', (e) => {
    e.preventDefault();
    e.stopPropagation();
    document.getElementById('uploadArea').classList.remove('dragover');

    const files = e.dataTransfer.files;
    if (files.length > 0) {
        document.getElementById('{{ form.file.id_for_label }}').files = files;
        // Update UI to show selected file
        const fileName = files[0].name;
        document.querySelector('#uploadArea p').textContent = `Selected: ${fileName}`;
    }
});

document.getElementById('{{ form.file.id_for_label }}').addEventListener('change', (e) => {
    const fileName = e.target.files[0]?.name;
    if (fileName) {
        document.querySelector('#uploadArea p').textContent = `Selected: ${fileName}`;
    }
});

document.querySelector('form').addEventListener('submit', (e) => {
    const btn = document.getElementById('uploadBtn');
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Uploading...';
});
</script>

<style>
.upload-area {
    border: 2px dashed #dee2e6;
    border-radius: 8px;
    padding: 3rem;
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
}

.upload-area:hover {
    border-color: #1f6b4f;
    background-color: rgba(13, 110, 253, 0.05);
}

.upload-area.dragover {
    border-color: #1f6b4f;
    background-color: rgba(13, 110, 253, 0.1);
}

.upload-area input[type="file"] {
    display: none;
}
</style>
{% endblock %}
